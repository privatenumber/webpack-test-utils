"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var w=require("webpack"),c=require("fs-require"),h=require("path"),d=require("memfs"),y=require("fs"),q=require("unionfs");function a(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var m=a(w),f=a(h),_=a(y);function b(){const e={};return e.promise=new Promise((r,n)=>{e.resolve=r,e.reject=n}),e}const p=e=>{const r=d.createFsFromVolume(d.Volume.fromJSON(e));return Object.assign(r,{join:f.default.join}),r};class j{constructor(r){this.options=r}apply(r){Object.assign(r,this.options)}}const F=()=>({mode:"production",target:"node",context:"/",entry:{index:"/src/index.js"},resolve:{modules:[f.default.resolve("node_modules"),"node_modules"]},resolveLoader:{modules:[f.default.resolve("node_modules"),"node_modules"]},module:{rules:[]},optimization:{minimize:!1},output:{filename:"[name].js",path:"/dist",libraryTarget:"commonjs2",libraryExport:"default"},plugins:[]});function v(e,r,n=m.default){const t=F();return r&&r(t),Array.isArray(t.plugins)||(t.plugins=[]),t.plugins.unshift(new j({inputFileSystem:new q.Union().use(_.default).use(e),outputFileSystem:e})),n(t)}const P=(e,r,n)=>{const t=p(e);return new Promise((l,s)=>{v(t,r,n).run((o,u)=>{if(o){s(o);return}l({stats:u,fs:t,require:c.createFsRequire(t)})})})},x=(e,r,n)=>{const t=p(e),l=v(t,r,n);let s,i=null;return{fs:t,require:c.createFsRequire(t),async build(o=(u=>(u=(n!=null?n:m.default).version)==null?void 0:u.startsWith("4."))()){if(i)throw new Error("Build in progress");return i=b(),s?o&&s.invalidate():s=l.watch({},async(u,g)=>{if(u){i==null||i.reject(u),i=null;return}i==null||i.resolve(g),i=null}),await i.promise},close:()=>new Promise(o=>{s?s.close(o):o()})}};exports.build=P,exports.watch=x;
